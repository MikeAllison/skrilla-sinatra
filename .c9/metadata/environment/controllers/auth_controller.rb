{"filter":false,"title":"auth_controller.rb","tooltip":"/controllers/auth_controller.rb","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":31,"column":3},"action":"insert","lines":["get '/login/?' do","  redirect to('/accounts') if @logged_in_user","","  erb :index","end","","post '/login' do","  user = User.find_by(username: (params[:username]).downcase)","","  if user && user.authenticate(params[:password])","    token = User.generate_random_token","    user.save_persistence_token(token)","    response.set_cookie(:p_token, value: token, expires: 1.day.from_now)","","    @logged_in_user = User.find_by_token(token)","","    redirect to('/accounts')","  else","    session[:message] = { :heading => 'Login Failed', :body => 'The username or password did not match our records.' }","","    redirect to ('/login')","  end","end","","get '/logout/?' do","  @logged_in_user.delete_persistence_token unless @logged_in_user.nil?","","  response.delete_cookie(:p_token)","  session[:message] = { :heading => 'Goodbye!', :body => 'You have logged out successfully.' }","","  redirect to('/login')","end"],"id":1}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":31,"column":3},"end":{"row":31,"column":3},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1570492414380,"hash":"ad710fda5d57f14793606a8a03576ce315b0f7ea"}