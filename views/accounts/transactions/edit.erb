<h2>Transaction Details</h2>

<form method="post" class="ui form">
  <div class="field">
    <label>Date</label>
    <input type="date" class="form-control" id="date" name="date" value="<%= @transaction.date %>">
  </div>
  <div id="merchant_dropdown" class="field">
    <label>Merchant - <a href="/merchants/new">Add</a></label>
    <select class="ui search dropdown" id="merchant_id" name="merchant_id">
      <% @merchants.each do |merchant| %>
        <option value="<%= merchant.id %>"><%= merchant.name %></option>
      <% end %>
    </select>
  </div>
  <div class="field">
    <label>Amount</label>
    <input type="text" class="form-control" id="amount" name="amount" aria-label="Dollar amount (with dot and two decimal places)" placeholder="<%= to_currency(@transaction.amount) %>">
  </div>
  <div class="field">
    <label style="margin-bottom:14px;">Credit?</label>
    <div class="ui slider checkbox">
      <input type="checkbox" id="credit" name="credit" tabindex="0" class="hidden">
      <label for="credit"></label>
    </div>
  </div>
  <div id="account_dropdown" class="field">
    <label>Account - <a href="/accounts/new">Add</a></label>
    <select class="ui search dropdown" id="account_id" name="account_id">
      <% @accounts.each do |account| %>
        <option value="<%= account.id %>"><%= account.name %></option>
      <% end %>
    </select>
  </div>

  <button type="submit" class="ui button">Submit</button>
  <a href="/accounts/<%= @transaction.account.url_safe_name %>/transactions" class="ui button">Cancel</a>
</form>

<script>
  $(function() {
    $('.ui.dropdown').dropdown();

    // Select the current merchant in the dropdown and Semantic UI
    $('#merchant_dropdown option[value="<%= @transaction.merchant.id %>"]').attr('selected', 'true');
    $('#merchant_dropdown div.text').text('<%= @transaction.merchant.name %>');
    $('#merchant_dropdown div.item').removeClass('active selected');
    $('#merchant_dropdown div.item[data-value="<%= @transaction.merchant.id %>"]').addClass('active selected');

    // Select the current account in the dropdown and Semantic UI
    $('#account_dropdown option[value="<%= @transaction.account.id %>"]').attr('selected', 'true');
    $('#account_dropdown div.text').text('<%= @transaction.account.name %>');
    $('#account_dropdown div.item').removeClass('active selected');
    $('#account_dropdown div.item[data-value="<%= @transaction.account.id %>"]').addClass('active selected');

    if (<%= @transaction.credit? %> === true) {
      $('#credit').attr('checked', 'checked');
    }
  });
</script>
